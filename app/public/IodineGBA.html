<!DOCTYPE html>
<html>

<head>
	<title>SHS Games IodineGBA Runner</title>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/includes/TypedArrayShim.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/Cartridge.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/DMA.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/Emulator.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/Graphics.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/RunLoop.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/Memory.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/IRQ.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/JoyPad.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/Serial.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/Sound.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/Timer.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/Wait.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/CPU.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/Saves.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/sound/FIFO.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/sound/Channel1.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/sound/Channel2.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/sound/Channel3.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/sound/Channel4.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/CPU/ARM.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/CPU/THUMB.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/CPU/CPSR.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/graphics/Renderer.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/graphics/RendererProxy.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/graphics/BGTEXT.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/graphics/BG2FrameBuffer.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/graphics/BGMatrix.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/graphics/AffineBG.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/graphics/ColorEffects.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/graphics/Mosaic.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/graphics/OBJ.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/graphics/OBJWindow.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/graphics/Window.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/graphics/Compositor.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/memory/DMA0.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/memory/DMA1.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/memory/DMA2.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/memory/DMA3.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/cartridge/SaveDeterminer.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/cartridge/SRAM.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/cartridge/FLASH.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/IodineGBA/core/cartridge/EEPROM.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/user_scripts/XAudioJS/swfobject.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/user_scripts/XAudioJS/resampler.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/user_scripts/XAudioJS/XAudioServer.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/user_scripts/IodineGBAROMLoadGlueCode.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/user_scripts/IodineGBAJoyPadGlueCode.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/user_scripts/IodineGBASavesGlueCode.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/user_scripts/IodineGBAGraphicsGlueCode.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/user_scripts/IodineGBAAudioGlueCode.js"></script>
	<script>
		"use strict";
		/*
		 * This file is part of IodineGBA
		 *
		 * Copyright (C) 2012-2013 Grant Galitz
		 *
		 * This program is free software; you can redistribute it and/or
		 * modify it under the terms of the GNU General Public License
		 * version 2 as published by the Free Software Foundation.
		 * The full license is available at http://www.gnu.org/licenses/gpl.html
		 *
		 * This program is distributed in the hope that it will be useful,
		 * but WITHOUT ANY WARRANTY; without even the implied warranty of
		 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
		 * GNU General Public License for more details.
		 *
		 */
		var Iodine = null;
		var Blitter = null;
		var Mixer = null;
		var MixerInput = null;
		var timerID = null;
		window.onload = function() {
			//Initialize Iodine:
			Iodine = new GameBoyAdvanceEmulator();
			//Initialize the graphics:
			registerBlitterHandler();
			//Initialize the audio:
			registerAudioHandler();
			//Register the save handler callbacks:
			registerSaveHandlers();
			//Hook the GUI controls.
			registerGUIEvents();
			//Enable Sound:
			Iodine.enableAudio();
			//Download the BIOS:
			downloadBIOS();
		}

		function downloadBIOS() {
			downloadFile("https://cdn.jsdelivr.net/gh/SHSGames/shsgames.github.io@10ce8f7b6a4ad83aa35a9448b51d6116f2d0de9d/www/src/IodineGBA/Binaries/gba_bios.bin", registerBIOS, true);
		}

		function registerBIOS() {
			processDownload(this, attachBIOS);
			downloadROM(location.hash.substr(1));
		}

		function downloadROM(gamename) {
			Iodine.pause();
			downloadFile(location.search.split("?")[1], registerROM, true);
		}

		function registerROM() {
			clearTempString();
			processDownload(this, attachROM);
			if (navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPod/i) || navigator.userAgent.match(/iPad/i)) {
				Iodine.disableAudio();
			}
			Iodine.play();
			window.parent.gbaloader.resolved = true;
			window.parent.gbaloader.destroy();
		}

		function registerBlitterHandler() {
			Blitter = new GlueCodeGfx();
			Blitter.attachCanvas(document.getElementById("emulator_target"));
			Blitter.setSmoothScaling(false);
			Iodine.attachGraphicsFrameHandler(function(buffer) {
				Blitter.copyBuffer(buffer);
			});
		}

		function registerAudioHandler() {
			Mixer = new GlueCodeMixer();
			MixerInput = new GlueCodeMixerInput(Mixer);
			Iodine.attachAudioHandler(MixerInput);
		}

		function registerGUIEvents() {
			addEvent("keydown", document, keyDown);
			addEvent("keyup", document, keyUpPreprocess);
			addEvent("unload", window, ExportSave);
		}

		function lowerVolume() {
			Iodine.incrementVolume(-0.04);
		}

		function raiseVolume() {
			Iodine.incrementVolume(0.04);
		}

		function writeRedTemporaryText(textString) {
			if (timerID) {
				clearTimeout(timerID);
			}
			showTempString(textString);
			timerID = setTimeout(clearTempString, 5000);
		}

		function showTempString(textString) {}
		function clearTempString() {}

		//Some wrappers and extensions for non-DOM3 browsers:
		function addEvent(sEvent, oElement, fListener) {
			try {
				oElement.addEventListener(sEvent, fListener, false);
			} catch (error) {
				oElement.attachEvent("on" + sEvent, fListener); //Pity for IE.
			}
		}

		function removeEvent(sEvent, oElement, fListener) {
			try {
				oElement.removeEventListener(sEvent, fListener, false);
			} catch (error) {
				oElement.detachEvent("on" + sEvent, fListener); //Pity for IE.
			}
		}
	</script>
</head>

<body style="margin: 0;">
	<canvas id="emulator_target" width="240px" height="160px"></canvas>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script>
		const canvas = $("#emulator_target");
		const resize = () => canvas.css({
			width: window.innerWidth,
			height: window.innerHeight
		});
		$(window).on("resize", resize).trigger("resize");
	</script>
</body>

</html>